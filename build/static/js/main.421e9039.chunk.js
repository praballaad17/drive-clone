(this["webpackJsonpe-store"]=this["webpackJsonpe-store"]||[]).push([[0],{73:function(e,t,r){},86:function(e,t,r){"use strict";r.r(t);var c=r(0),n=r.n(c),a=r(26),s=r.n(a),i=(r(73),r(13)),l=r(11),o=r(10),d=r(14),u=r(62),j=(r(74),r(87),r(88),u.a.initializeApp({apiKey:"AIzaSyCgm_3DefJI9hj9CIGbcSv4EWPlAUwAWh0",authDomain:"auth-development-5fdbc.firebaseapp.com",databaseURL:"https://auth-development-5fdbc-default-rtdb.firebaseio.com/",projectId:"auth-development-5fdbc",storageBucket:"auth-development-5fdbc.appspot.com",messagingSenderId:"665839052346",appId:"1:665839052346:web:d54dffa7e271e7649fb703"})),b=j.firestore(),h={folders:b.collection("folders"),files:b.collection("files"),formatDoc:function(e){return Object(d.a)({id:e.id},e.data())},getCurrentTimeStamp:u.a.firestore.FieldValue.serverTimestamp},p=j.storage(),f=j,O=r(2),x=f.auth(),m=n.a.createContext();function v(){return Object(c.useContext)(m)}function g(e){var t=e.children,r=Object(c.useState)(),n=Object(o.a)(r,2),a=n[0],s=n[1],i=Object(c.useState)(!1),l=Object(o.a)(i,2),d=l[0],u=l[1];Object(c.useEffect)((function(){return x.onAuthStateChanged((function(e){s(e),u(!1)}))}),[]);var j={currentUser:a,signup:function(e,t){return x.createUserWithEmailAndPassword(e,t)},login:function(e,t){return x.signInWithEmailAndPassword(e,t)},logout:function(){return x.signOut()},forgetPassword:function(e){return x.sendPasswordResetEmail(e)},updateEmail:function(e){return a.updateEmail(e)},updatePassword:function(e){return a.updatePassword(e)},deleteUser:function(){return a.delete()}};return Object(O.jsx)(m.Provider,{value:j,children:!d&&t})}m.displayName="AuthContext";var w=r(20),y=r.n(w),N=r(28),S=r(99),F=r(92),C=r(95),k=r(93),I=r(91);function P(e){var t=e.children;return Object(O.jsx)(I.a,{className:"d-flex align-items-center justify-content-center",style:{minHeight:"100vh"},children:Object(O.jsx)("div",{className:"w-100",style:{maxWidth:"400px"},children:t})})}function L(){var e=Object(c.useRef)(),t=Object(c.useRef)(),r=Object(c.useRef)(),n=Object(c.useState)(""),a=Object(o.a)(n,2),s=a[0],d=a[1],u=Object(c.useState)(!1),j=Object(o.a)(u,2),b=j[0],h=j[1],p=v().signup,f=Object(l.g)();function x(){return(x=Object(N.a)(y.a.mark((function c(n){return y.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(n.preventDefault(),t.current.value===r.current.value){c.next=3;break}return c.abrupt("return",d("Password do not match"));case 3:return c.prev=3,d(""),h(!0),c.next=8,p(e.current.value,t.current.value);case 8:f.push("/"),c.next=14;break;case 11:c.prev=11,c.t0=c.catch(3),d("Failed to create an account");case 14:h(!1);case 15:case"end":return c.stop()}}),c,null,[[3,11]])})))).apply(this,arguments)}return Object(O.jsxs)(P,{children:[Object(O.jsx)(S.a,{children:Object(O.jsxs)(S.a.Body,{children:[Object(O.jsx)("h2",{className:"text-center mb-4",children:"Sign UP"}),s&&Object(O.jsx)(F.a,{variant:"danger",children:s}),Object(O.jsxs)(C.a,{onSubmit:function(e){return x.apply(this,arguments)},children:[Object(O.jsxs)(C.a.Group,{id:"email",children:[Object(O.jsx)(C.a.Label,{children:"Email"}),Object(O.jsx)(C.a.Control,{type:"email",ref:e,required:!0})]}),Object(O.jsxs)(C.a.Group,{id:"password",children:[Object(O.jsx)(C.a.Label,{children:"Password"}),Object(O.jsx)(C.a.Control,{type:"password",ref:t})]}),Object(O.jsxs)(C.a.Group,{id:"password-confirm",children:[Object(O.jsx)(C.a.Label,{children:"Password confirmation"}),Object(O.jsx)(C.a.Control,{type:"password",ref:r})]}),Object(O.jsx)(k.a,{disabled:b,className:"w-100",type:"submit",children:"Sign Up"})]})]})}),Object(O.jsxs)("div",{className:"w-100 text-center mt-2",children:["Already have an account?",Object(O.jsx)(i.b,{to:"/login",children:"Log In"})]})]})}function E(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),r=t[0],n=t[1],a=v(),s=a.currentUser,d=a.logout,u=a.deleteUser,j=Object(c.useState)(!1),b=Object(o.a)(j,2),h=(b[0],b[1]),p=Object(l.g)();function f(){return(f=Object(N.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(""),e.prev=1,e.next=4,d();case 4:h(!0),p.push("/login"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),n("Failed to log out");case 11:h(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}function x(){return(x=Object(N.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(""),e.prev=1,e.next=4,u();case 4:h(!0),p.push("/login"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),n("Failed to Delete");case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}return Object(O.jsxs)(P,{children:[Object(O.jsx)(S.a,{children:Object(O.jsxs)(S.a.Body,{children:[Object(O.jsx)("h2",{className:"text-center mb-4",children:"Profile"}),r&&Object(O.jsx)(F.a,{variant:"danger",children:r}),Object(O.jsx)("strong",{children:"Email:"}),s.email,Object(O.jsx)(i.b,{to:"/update-profile",className:"btn btn-primary w-100 mt-3",children:"Update"}),Object(O.jsx)(k.a,{onClick:function(){return f.apply(this,arguments)},className:"btn btn-secondary w-100 mt-3",children:"Log Out"}),Object(O.jsx)(k.a,{onClick:function(){return x.apply(this,arguments)},className:"btn btn-danger w-100 mt-3",children:"Delete Your Account"})]})}),Object(O.jsx)("div",{className:"w-100 text-center mt-2",children:Object(O.jsx)(i.b,{to:"/",children:"Cancel"})})]})}function U(){var e=Object(c.useRef)(),t=Object(c.useRef)(),r=Object(c.useState)(""),n=Object(o.a)(r,2),a=n[0],s=n[1],d=Object(c.useState)(!1),u=Object(o.a)(d,2),j=(u[0],u[1]),b=v().login,h=Object(l.g)();function p(){return(p=Object(N.a)(y.a.mark((function r(c){return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c.preventDefault(),r.prev=1,s(""),j(!0),r.next=6,b(e.current.value,t.current.value);case 6:h.push("/"),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(1),s("Failed to sign in!");case 12:j(!1);case 13:case"end":return r.stop()}}),r,null,[[1,9]])})))).apply(this,arguments)}return Object(O.jsxs)(P,{children:[Object(O.jsx)(S.a,{children:Object(O.jsxs)(S.a.Body,{children:[Object(O.jsx)("h2",{className:"text-center mb-4",children:"Log IN"}),a&&Object(O.jsx)(F.a,{variant:"danger",children:a}),Object(O.jsxs)(C.a,{onSubmit:function(e){return p.apply(this,arguments)},children:[Object(O.jsxs)(C.a.Group,{id:"email",children:[Object(O.jsx)(C.a.Label,{children:"Email"}),Object(O.jsx)(C.a.Control,{type:"email",ref:e,required:!0})]}),Object(O.jsxs)(C.a.Group,{id:"password",children:[Object(O.jsx)(C.a.Label,{children:"Password"}),Object(O.jsx)(C.a.Control,{type:"password",ref:t})]}),Object(O.jsx)(k.a,{className:"w-100",type:"submit",children:"Log In"})]}),Object(O.jsx)("div",{className:"w-100 text-center mt-3",children:Object(O.jsx)(i.b,{to:"/forgetpassword",children:"Forget Password"})})]})}),Object(O.jsxs)("div",{className:"w-100 text-center mt-2",children:["Don't have an account?",Object(O.jsx)(i.b,{to:"/signup",children:"Sign Up"})]})]})}var D=r(68);function R(e){var t=e.component,r=Object(D.a)(e,["component"]),c=v().currentUser;return Object(O.jsx)(l.b,Object(d.a)(Object(d.a)({},r),{},{render:function(e){return c?Object(O.jsx)(t,Object(d.a)({},e)):Object(O.jsx)(l.a,{to:"/login"})}}))}function A(){var e=Object(c.useRef)(),t=Object(c.useState)(""),r=Object(o.a)(t,2),n=r[0],a=r[1],s=Object(c.useState)(""),l=Object(o.a)(s,2),d=l[0],u=l[1],j=Object(c.useState)(!1),b=Object(o.a)(j,2),h=(b[0],b[1]),p=v().forgetPassword;function f(){return(f=Object(N.a)(y.a.mark((function t(r){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),t.prev=1,a(""),u(""),h(!0),t.next=7,p(e.current.value);case 7:u("Check your Inbox for funther Instruction."),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),a("Failed to reset!");case 13:h(!1);case 14:case"end":return t.stop()}}),t,null,[[1,10]])})))).apply(this,arguments)}return Object(O.jsxs)(P,{children:[Object(O.jsx)(S.a,{children:Object(O.jsxs)(S.a.Body,{children:[Object(O.jsx)("h2",{className:"text-center mb-4",children:"Reset Password"}),n&&Object(O.jsx)(F.a,{variant:"danger",children:n}),d&&Object(O.jsx)(F.a,{variant:"success",children:d}),Object(O.jsxs)(C.a,{onSubmit:function(e){return f.apply(this,arguments)},children:[Object(O.jsxs)(C.a.Group,{id:"email",children:[Object(O.jsx)(C.a.Label,{children:"Email"}),Object(O.jsx)(C.a.Control,{type:"email",ref:e,required:!0})]}),Object(O.jsx)(k.a,{className:"w-100",type:"submit",children:"Reset Password"})]}),Object(O.jsx)("div",{className:"w-100 text-center mt-3",children:Object(O.jsx)(i.b,{to:"/login",children:"Log In"})})]})}),Object(O.jsxs)("div",{className:"w-100 text-center mt-2",children:["Don't have an account?",Object(O.jsx)(i.b,{to:"/signup",children:"Sign Up"})]})]})}function B(){var e=Object(c.useRef)(),t=Object(c.useRef)(),r=Object(c.useRef)(),n=Object(c.useState)(""),a=Object(o.a)(n,2),s=a[0],d=a[1],u=Object(c.useState)(!1),j=Object(o.a)(u,2),b=j[0],h=j[1],p=v(),f=p.currentUser,x=p.updateEmail,m=p.updatePassword,g=Object(l.g)();return Object(O.jsxs)(P,{children:[Object(O.jsx)(S.a,{children:Object(O.jsxs)(S.a.Body,{children:[Object(O.jsx)("h2",{className:"text-center mb-4",children:"Update Profile"}),s&&Object(O.jsx)(F.a,{variant:"danger",children:s}),Object(O.jsxs)(C.a,{onSubmit:function(c){if(c.preventDefault(),t.current.value!==r.current.value)return d("Password do not match");var n=[];h(!0),d(""),e.current.value!==f.email&&n.push(x(e.current.value)),t.current.value&&n.push(m(t.current.value)),Promise.all(n).then((function(){g.push("/user")})).catch((function(){d("Failed to update account")})).finally((function(){h(!1)}))},children:[Object(O.jsxs)(C.a.Group,{id:"email",children:[Object(O.jsx)(C.a.Label,{children:"Email"}),Object(O.jsx)(C.a.Control,{defaultValue:f.email,type:"email",ref:e,required:!0})]}),Object(O.jsxs)(C.a.Group,{id:"password",children:[Object(O.jsx)(C.a.Label,{children:"Password"}),Object(O.jsx)(C.a.Control,{placeholder:"Leave blank to keep the password",type:"password",ref:t})]}),Object(O.jsxs)(C.a.Group,{id:"password-confirm",children:[Object(O.jsx)(C.a.Label,{children:"Password confirmation"}),Object(O.jsx)(C.a.Control,{placeholder:"Leave blank to keep the password",type:"password",ref:r})]}),Object(O.jsx)(k.a,{disabled:b,className:"w-100",type:"submit",children:"Update"})]})]})}),Object(O.jsx)("div",{className:"w-100 text-center mt-2",children:Object(O.jsx)(i.b,{to:"/user",children:"Cancel"})})]})}var G="select-folder",W="update-folder",T="set-child-folders",q="set-child-files",z={name:"Root",id:null,path:[]};function H(e,t){var r=t.type,c=t.payload;switch(r){case G:return{folderId:c.folderId,folder:c.folder,childFiles:[],childFolders:[]};case W:return Object(d.a)(Object(d.a)({},e),{},{folder:c.folder});case T:return Object(d.a)(Object(d.a)({},e),{},{childFolders:c.childFolders});case q:return Object(d.a)(Object(d.a)({},e),{},{childFiles:c.childFiles});default:return e}}var J=r(41),_=r(35),M=r(34),V=r(98),K=r(100),Y=r(58);function Q(e){var t=e.currentFolder,r=Object(c.useState)([]),n=Object(o.a)(r,2),a=n[0],i=n[1],l=v().currentUser;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("label",{className:"btn btn-outline-success btn-md m-0 mr-2",children:[Object(O.jsx)(M.a,{icon:_.b}),Object(O.jsx)("input",{type:"file",onChange:function(e){var r=e.target.files[0];if(null!=t&&null!=r){var c=Object(V.a)();i((function(e){return[].concat(Object(J.a)(e),[{id:c,name:r.name,progress:0,error:!1}])}));var n=t===z?"".concat(t.path.join("/"),"/").concat(r.name):"".concat(t.path.join("/"),"/").concat(t.name,"/").concat(r.name),a=p.ref("/files/".concat(l.uid,"/").concat(n)).put(r);console.log(a.snapshot.ref.getDownloadURL()),a.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes;i((function(e){return e.map((function(e){return e.id===c?Object(d.a)(Object(d.a)({},e),{},{progress:t}):e}))}))}),(function(){i((function(e){return e.map((function(e){return e.id===c?Object(d.a)(Object(d.a)({},e),{},{error:!0}):e}))}))}),(function(){i((function(e){return e.filter((function(e){return e.id!==c}))})),a.snapshot.ref.getDownloadURL().then((function(e){h.files.add({url:e,name:r.name,createAt:h.getCurrentTimeStamp(),folderId:t.id,userId:l.uid})}))}))}},style:{opacity:0,position:"absolute",left:"-99999px"}})]}),a.length>0&&s.a.createPortal(Object(O.jsx)("div",{style:{position:"absolute",bottom:"1rem",right:"1rem",maxWidth:"250px"},children:a.map((function(e){return Object(O.jsxs)(Y.a,{onClose:function(){i((function(t){return t.filter((function(t){return t.id!==e.id}))}))},children:[Object(O.jsx)(Y.a.Header,{className:"text-truncate w-100 d-block",children:Object(O.jsx)("strong",{className:"mr-auto",children:e.name})}),Object(O.jsx)(Y.a.Body,{children:Object(O.jsx)(K.a,{animated:!e.error,variant:e.error?"danger":"primary",now:e.error?100:100*e.progress,label:e.error?"Error":"".concat(Math.round(100*e.progress),"%")})})]},e.id)}))}),document.body)]})}var X=r(94);function Z(e){var t=e.currentFolder,r=Object(c.useState)(!1),n=Object(o.a)(r,2),a=n[0],s=n[1],i=Object(c.useState)(""),l=Object(o.a)(i,2),d=l[0],u=l[1],j=v().currentUser;function b(){s(!1)}return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(k.a,{onClick:function(){s(!0)},variant:"outline-success",size:"md",children:Object(O.jsx)(M.a,{icon:_.d})}),Object(O.jsx)(X.a,{show:a,onHide:b,children:Object(O.jsxs)(C.a,{onSubmit:function(e){if(e.preventDefault(),null!=t){var r=Object(J.a)(t.path);t!==z&&r.push({name:t.name,id:t.id}),h.folders.add({name:d,parentId:t.id,userId:j.uid,path:r,createdAt:h.getCurrentTimeStamp()}),u(""),b()}},children:[Object(O.jsx)(X.a.Body,{children:Object(O.jsxs)(C.a.Group,{children:[Object(O.jsx)(C.a.Label,{children:"Folder Name"}),Object(O.jsx)(C.a.Control,{type:"text",required:!0,value:d,onChange:function(e){return u(e.target.value)}})]})}),Object(O.jsxs)(X.a.Footer,{children:[Object(O.jsx)(k.a,{variant:"secondary",onClick:b,children:"Close"}),Object(O.jsx)(k.a,{variant:"success",type:"submit",children:"Add Folder"})]})]})})]})}function $(e){var t=e.folder;return Object(O.jsxs)(k.a,{to:{pathname:"/folder/".concat(t.id),state:{folder:t}},className:"text-truncate w-100",variant:"outline-dark",as:i.b,children:[Object(O.jsx)(M.a,{icon:_.c,className:"mr-2"}),t.name]})}function ee(e){var t=e.file;return Object(O.jsxs)("a",{href:t.url,target:"_blank",className:"btn btn-outline-dark\r text-truncate w-100",children:[Object(O.jsx)(M.a,{icon:_.a,className:"mr-2"}),t.name]})}var te=r(101);function re(e){var t=e.currentFolder,r=t===z?[]:[z];return t&&(r=[].concat(Object(J.a)(r),Object(J.a)(t.path))),Object(O.jsxs)(te.a,{className:"flex-grow-1 m-0",listProps:{className:"bg-white m-0 pl-0"},children:[r.map((function(e,t){return Object(O.jsx)(te.a.Item,{linkAs:i.b,linkProps:{to:{pathname:e.id?"/folder/".concat(e.id):"/",state:{folder:Object(d.a)(Object(d.a)({},e),{},{path:r.slice(1,t)})}}},className:"text-truncate d-inline-block",style:{maxWidth:"150px"},children:e.name},e.id)})),t&&Object(O.jsx)(te.a.Item,{className:"text-truncate d-inline-block",style:{maxWidth:"200px"},active:!0,children:t.name})]})}var ce=r(97),ne=r(96);function ae(){return Object(O.jsxs)(ce.a,{bg:"light",expand:"x-lg",children:[Object(O.jsx)(ce.a.Brand,{className:"mx-5",as:i.b,to:"/",children:"E-STORE"}),Object(O.jsx)(ne.a,{children:Object(O.jsx)(ne.a.Link,{className:"mx-5",as:i.b,to:"/user",children:"Profile"})})]})}function se(){var e=Object(l.i)().folderId,t=Object(l.h)().state,r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=Object(c.useReducer)(H,{folderId:e,folder:t,childFolders:[],childFiles:[]}),n=Object(o.a)(r,2),a=n[0],s=n[1],i=v().currentUser;return Object(c.useEffect)((function(){s({type:G,payload:{folderId:e,folder:t}})}),[e,t]),Object(c.useEffect)((function(){if(null==e)return s({type:W,payload:{folder:z}});h.folders.doc(e).get().then((function(e){s({type:W,payload:{folder:h.formatDoc(e)}})})).catch((function(){s({type:W,payload:{folder:z}})}))}),[e]),Object(c.useEffect)((function(){return h.folders.where("parentId","==",e).where("userId","==",i.uid).orderBy("createdAt").onSnapshot((function(e){s({type:T,payload:{childFolders:e.docs.map(h.formatDoc)}})}))}),[e,i]),Object(c.useEffect)((function(){return h.files.where("folderId","==",e).where("userId","==",i.uid).onSnapshot((function(e){s({type:q,payload:{childFiles:e.docs.map(h.formatDoc)}})}))}),[e,i]),a}(e,(void 0===t?{}:t).folder),n=r.folder,a=r.childFolders,s=r.childFiles;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(ae,{}),Object(O.jsxs)(I.a,{fluid:!0,children:[Object(O.jsxs)("div",{className:"d-flex align-items-center mt-2",children:[Object(O.jsx)(re,{currentFolder:n}),Object(O.jsx)(Q,{currentFolder:n}),Object(O.jsx)(Z,{currentFolder:n})]}),a.length>0&&Object(O.jsx)("div",{className:"d-flex flex-wrap",children:a.map((function(e){return Object(O.jsx)("div",{style:{maxWidth:"200px"},className:"p-2",children:Object(O.jsx)($,{folder:e})},e.id)}))}),a.length>0&&s.length>0&&Object(O.jsx)("hr",{}),s.length>0&&Object(O.jsx)("div",{className:"d-flex flex-wrap",children:s.map((function(e){return Object(O.jsx)("div",{style:{maxWidth:"200px"},className:"p-2",children:Object(O.jsx)(ee,{file:e})},e.id)}))})]})]})}var ie=function(){return Object(O.jsx)(i.a,{children:Object(O.jsx)(g,{children:Object(O.jsxs)(l.d,{children:[Object(O.jsx)(R,{exact:!0,path:"/",component:se}),Object(O.jsx)(R,{exact:!0,path:"/folder/:folderId",component:se}),Object(O.jsx)(R,{path:"/user",component:E}),Object(O.jsx)(R,{exact:!0,path:"/update-profile",component:B}),Object(O.jsx)(l.b,{path:"/signup",component:L}),Object(O.jsx)(l.b,{path:"/forgetpassword",component:A}),Object(O.jsx)(l.b,{path:"/login",component:U})]})})})},le=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,102)).then((function(t){var r=t.getCLS,c=t.getFID,n=t.getFCP,a=t.getLCP,s=t.getTTFB;r(e),c(e),n(e),a(e),s(e)}))};r(85);s.a.render(Object(O.jsx)(n.a.StrictMode,{children:Object(O.jsx)(ie,{})}),document.getElementById("root")),le()}},[[86,1,2]]]);
//# sourceMappingURL=main.421e9039.chunk.js.map